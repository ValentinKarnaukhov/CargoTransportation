$(document).ready(function(){var t;$(".table").DataTable({pagingType:"simple_numbers"}),1==(t={},window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,i){t[n]=i}),t).error&&M.toast({html:"Server error"}),$("select").formSelect(),$(".tabs").tabs(),$(".sidenav").sidenav(),$("#changeCity").on("click",function(){$("#city_ok").show(),$("#city_decline").show()}),$("#city_ok").on("click",function(){var t=$("meta[name='_csrf']").attr("content"),e=$("meta[name='_csrf_header']").attr("content");$.ajax({beforeSend:function(n){n.setRequestHeader(e,t)},type:"put",url:"/driver/"+$("#driver_id").val()+"/changeCity",contentType:"application/json",dataType:"json",data:JSON.stringify({city_id:$("#changeCity option:selected").val()})}),$("#city_ok").hide(),$("#city_decline").hide()}),$("#city_decline").on("click",function(){$("#city_ok").hide(),$("#city_decline").hide()}),$("#changeStatus").on("click",function(){$("#ok").show(),$("#decline").show()}),$("#ok").on("click",function(){$.ajax({type:"get",contentType:"application/json",url:"/driver/"+$("#driver_id").val()+"/change",data:{status:$("#changeStatus option:selected").text()}}),$("#ok").hide(),$("#decline").hide()}),$("#decline").on("click",function(){$("#ok").hide(),$("#decline").hide()}),$(".truck-status").on("click",function(){var t,e=$(".truck-status");e.hasClass("green-text")?(e.removeClass("green-text"),e.addClass("red-text"),t="BROKEN"):(e.removeClass("red-text"),e.addClass("green-text"),t="OK"),$.ajax({type:"get",contentType:"application/json",url:"/truck/changeStatus",data:{number:$.trim($("#reg-number").clone().children().remove().end().text()),status:t}})})}),$("[name = finish]").on("submit",function(){var t=$(".active").length-1,e=$(".maxDrivers").val(),n=$(".errors");if(n.empty(),t!=e)return n.append("You should choose ",e," drivers"),!1}),1==$(".created").length&&M.toast({html:"Order was created"},2e3),$(document).on("click",".row_data",function(){var t=$(this).closest("tr");t.find(".btn_ok").show(),t.find(".btn_decline").show()}),$(document).on("click",".btn_ok",function(){var t=$("meta[name='_csrf']").attr("content"),e=$("meta[name='_csrf_header']").attr("content"),n=$(this).closest("tr"),i=n.attr("row_id");$.ajax({beforeSend:function(n){n.setRequestHeader(e,t)},type:"put",url:"/driver/cargo_change",contentType:"application/json",dataType:"json",data:JSON.stringify({point_id:i,status:n.find(".cargoStatus option:selected").text()})}).done(function(t){if(0===t.point_id)return n.empty(),M.toast({html:"Order was completed"},2e3),!1;"DONE"===t.status&&n.empty(),n.attr("row_id",t.point_id),n.find(".city").text(t.city),n.find(".operation").text("UNLOADING"),n.find(".cargoStatus option[value=1]").prop("selected",!0)}),n.find(".btn_ok").hide(),n.find(".btn_decline").hide()}),$(document).on("click",".btn_decline",function(){var t=$(this).closest("tr");t.find(".btn_ok").hide(),t.find(".btn_decline").hide(),t.find(".cargoStatus option[value=1]").prop("selected",!0)});